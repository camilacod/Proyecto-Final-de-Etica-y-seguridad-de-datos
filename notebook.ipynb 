{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Etica y Seguridad de Datos - Proyecto Final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Driving_License</th>\n",
       "      <th>Previously_Insured</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Vehicle_Damage</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Vintage</th>\n",
       "      <th>Response</th>\n",
       "      <th>First</th>\n",
       "      <th>Last</th>\n",
       "      <th>Phone</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2630.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>Edwin</td>\n",
       "      <td>Castillo</td>\n",
       "      <td>(412) 532-3071</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "      <td>vifma@malac.it</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>33053.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>66</td>\n",
       "      <td>0</td>\n",
       "      <td>Jay</td>\n",
       "      <td>Simpson</td>\n",
       "      <td>(324) 235-5322</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "      <td>nur@kegumi.ai</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>35804.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>150</td>\n",
       "      <td>0</td>\n",
       "      <td>Willie</td>\n",
       "      <td>Bowman</td>\n",
       "      <td>(640) 936-5852</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "      <td>ohehuc@damow.mx</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>No</td>\n",
       "      <td>39874.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>Lillian</td>\n",
       "      <td>Parsons</td>\n",
       "      <td>(864) 621-4575</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "      <td>wegev@nohosu.ga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>38933.0</td>\n",
       "      <td>156.0</td>\n",
       "      <td>186</td>\n",
       "      <td>0</td>\n",
       "      <td>Carrie</td>\n",
       "      <td>Cooper</td>\n",
       "      <td>(586) 867-8845</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "      <td>saw@zevjad.sm</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Driving_License  Previously_Insured  Vehicle_Age  \\\n",
       "0    Male   57                1                   1          2.0   \n",
       "1  Female   23                1                   1          1.0   \n",
       "2  Female   47                1                   1          2.0   \n",
       "3    Male   27                1                   1          1.0   \n",
       "4  Female   47                1                   0          2.0   \n",
       "\n",
       "  Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  Vintage  Response  \\\n",
       "0             No          2630.0                  26.0       36         0   \n",
       "1            Yes         33053.0                 152.0       66         0   \n",
       "2             No         35804.0                 124.0      150         0   \n",
       "3             No         39874.0                 152.0       27         0   \n",
       "4            Yes         38933.0                 156.0      186         0   \n",
       "\n",
       "     First      Last           Phone          Ccnumber           Address  \\\n",
       "0    Edwin  Castillo  (412) 532-3071  6375508819454279   716 Kuchu Grove   \n",
       "1      Jay   Simpson  (324) 235-5322  5468218154515383     468 Tube Loop   \n",
       "2   Willie    Bowman  (640) 936-5852  4903855020206477     271 Ecgek Key   \n",
       "3  Lillian   Parsons  (864) 621-4575   349976912136984  1059 Pivsog Lane   \n",
       "4   Carrie    Cooper  (586) 867-8845  3528302763283717   431 Nosvid Glen   \n",
       "\n",
       "  Country            Email  \n",
       "0      EH   vifma@malac.it  \n",
       "1      CH    nur@kegumi.ai  \n",
       "2      AL  ohehuc@damow.mx  \n",
       "3      ZW  wegev@nohosu.ga  \n",
       "4      PR    saw@zevjad.sm  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pd.read_csv(\"datafinal.csv\")\n",
    "data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Contamos con estas variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Gender, Age, Driving_License, Previously_Insured, Vehicle_Age, Vehicle_Damage, Annual_Premium, Policy_Sales_Channel, Vintage, Response, First, Last, Phone, Ccnumber, Address, Country, Email, "
     ]
    }
   ],
   "source": [
    "for col in data.columns:\n",
    "    print(col, end=\", \")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Clasificamos los datos que tenemos segun sus diferentes tipos:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Datos Identificables: DROP\n",
    "- First \n",
    "- Last\n",
    "- Phone\n",
    "- Email\n",
    "# Datos Casi Identificables: KEEP\n",
    "- Age \n",
    "- Gender\n",
    "- Country\n",
    "- Previously_Insured\n",
    "- Vehicle_Age \n",
    "- Vehicle_Damage\n",
    "- Vintage\n",
    "- Response\n",
    "- Driving_License\n",
    "- address \n",
    "- Policy_Sales_Channel\n",
    "# Datos Sensibles:\n",
    "- CCNumber\n",
    "- Annual_Premium\n",
    "\n",
    "Cuales son las decisiones a tomar?\n",
    "\n",
    "- Droppear los datos identificables, pues estos solo ponen en riesgo y facilitan la identificación de un cliente en particular.\n",
    "\n",
    "- Mantener los datos casi identificables y sensibles para un análisis próximo, pues son estos los que nos permitirán, en su mayoría, retener la mayor información útil para el análisis a realizar.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Driving_License</th>\n",
       "      <th>Previously_Insured</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Vehicle_Damage</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Vintage</th>\n",
       "      <th>Response</th>\n",
       "      <th>First</th>\n",
       "      <th>Last</th>\n",
       "      <th>Phone</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2630.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>Edwin</td>\n",
       "      <td>Castillo</td>\n",
       "      <td>(412) 532-3071</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "      <td>vifma@malac.it</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>33053.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>66</td>\n",
       "      <td>0</td>\n",
       "      <td>Jay</td>\n",
       "      <td>Simpson</td>\n",
       "      <td>(324) 235-5322</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "      <td>nur@kegumi.ai</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>35804.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>150</td>\n",
       "      <td>0</td>\n",
       "      <td>Willie</td>\n",
       "      <td>Bowman</td>\n",
       "      <td>(640) 936-5852</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "      <td>ohehuc@damow.mx</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>No</td>\n",
       "      <td>39874.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>Lillian</td>\n",
       "      <td>Parsons</td>\n",
       "      <td>(864) 621-4575</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "      <td>wegev@nohosu.ga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>38933.0</td>\n",
       "      <td>156.0</td>\n",
       "      <td>186</td>\n",
       "      <td>0</td>\n",
       "      <td>Carrie</td>\n",
       "      <td>Cooper</td>\n",
       "      <td>(586) 867-8845</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "      <td>saw@zevjad.sm</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Driving_License  Previously_Insured  Vehicle_Age  \\\n",
       "0    Male   57                1                   1          2.0   \n",
       "1  Female   23                1                   1          1.0   \n",
       "2  Female   47                1                   1          2.0   \n",
       "3    Male   27                1                   1          1.0   \n",
       "4  Female   47                1                   0          2.0   \n",
       "\n",
       "  Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  Vintage  Response  \\\n",
       "0             No          2630.0                  26.0       36         0   \n",
       "1            Yes         33053.0                 152.0       66         0   \n",
       "2             No         35804.0                 124.0      150         0   \n",
       "3             No         39874.0                 152.0       27         0   \n",
       "4            Yes         38933.0                 156.0      186         0   \n",
       "\n",
       "     First      Last           Phone          Ccnumber           Address  \\\n",
       "0    Edwin  Castillo  (412) 532-3071  6375508819454279   716 Kuchu Grove   \n",
       "1      Jay   Simpson  (324) 235-5322  5468218154515383     468 Tube Loop   \n",
       "2   Willie    Bowman  (640) 936-5852  4903855020206477     271 Ecgek Key   \n",
       "3  Lillian   Parsons  (864) 621-4575   349976912136984  1059 Pivsog Lane   \n",
       "4   Carrie    Cooper  (586) 867-8845  3528302763283717   431 Nosvid Glen   \n",
       "\n",
       "  Country            Email  \n",
       "0      EH   vifma@malac.it  \n",
       "1      CH    nur@kegumi.ai  \n",
       "2      AL  ohehuc@damow.mx  \n",
       "3      ZW  wegev@nohosu.ga  \n",
       "4      PR    saw@zevjad.sm  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy = data.copy()\n",
    "datacopy.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "datacopy.drop(['First','Last','Phone','Email'], axis=1, inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Driving_License</th>\n",
       "      <th>Previously_Insured</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Vehicle_Damage</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Vintage</th>\n",
       "      <th>Response</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2630.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>33053.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>66</td>\n",
       "      <td>0</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>35804.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>150</td>\n",
       "      <td>0</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>No</td>\n",
       "      <td>39874.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>38933.0</td>\n",
       "      <td>156.0</td>\n",
       "      <td>186</td>\n",
       "      <td>0</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Driving_License  Previously_Insured  Vehicle_Age  \\\n",
       "0    Male   57                1                   1          2.0   \n",
       "1  Female   23                1                   1          1.0   \n",
       "2  Female   47                1                   1          2.0   \n",
       "3    Male   27                1                   1          1.0   \n",
       "4  Female   47                1                   0          2.0   \n",
       "\n",
       "  Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  Vintage  Response  \\\n",
       "0             No          2630.0                  26.0       36         0   \n",
       "1            Yes         33053.0                 152.0       66         0   \n",
       "2             No         35804.0                 124.0      150         0   \n",
       "3             No         39874.0                 152.0       27         0   \n",
       "4            Yes         38933.0                 156.0      186         0   \n",
       "\n",
       "           Ccnumber           Address Country  \n",
       "0  6375508819454279   716 Kuchu Grove      EH  \n",
       "1  5468218154515383     468 Tube Loop      CH  \n",
       "2  4903855020206477     271 Ecgek Key      AL  \n",
       "3   349976912136984  1059 Pivsog Lane      ZW  \n",
       "4  3528302763283717   431 Nosvid Glen      PR  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 389,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pycanon import anonymity, report"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Recordando los datos que planteamos analizar de aquí en adelante"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Casi Identificables: KEEP\n",
    "- Age \n",
    "- Gender\n",
    "- Country\n",
    "- Previously_Insured\n",
    "- Vehicle_Age \n",
    "- Vehicle_Damage\n",
    "- Vintage\n",
    "- Response\n",
    "- Driving_License\n",
    "- address \n",
    "- Policy_Sales_Channel\n",
    "# Sensibles: KEEP\n",
    "- CCNumber\n",
    "- Annual_Premium"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Gender', 'Age', 'Driving_License', 'Previously_Insured', 'Vehicle_Age',\n",
       "       'Vehicle_Damage', 'Annual_Premium', 'Policy_Sales_Channel', 'Vintage',\n",
       "       'Response', 'Ccnumber', 'Address', 'Country'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "QI = ['Age','Gender','Country','Vehicle_Age','Address','Policy_Sales_Channel']\n",
    "SA = ['Ccnumber','Annual_Premium']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Driving_License</th>\n",
       "      <th>Previously_Insured</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Vehicle_Damage</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Vintage</th>\n",
       "      <th>Response</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2630.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>33053.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>66</td>\n",
       "      <td>0</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>35804.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>150</td>\n",
       "      <td>0</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>No</td>\n",
       "      <td>39874.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>38933.0</td>\n",
       "      <td>156.0</td>\n",
       "      <td>186</td>\n",
       "      <td>0</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Driving_License  Previously_Insured  Vehicle_Age  \\\n",
       "0    Male   57                1                   1          2.0   \n",
       "1  Female   23                1                   1          1.0   \n",
       "2  Female   47                1                   1          2.0   \n",
       "3    Male   27                1                   1          1.0   \n",
       "4  Female   47                1                   0          2.0   \n",
       "\n",
       "  Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  Vintage  Response  \\\n",
       "0             No          2630.0                  26.0       36         0   \n",
       "1            Yes         33053.0                 152.0       66         0   \n",
       "2             No         35804.0                 124.0      150         0   \n",
       "3             No         39874.0                 152.0       27         0   \n",
       "4            Yes         38933.0                 156.0      186         0   \n",
       "\n",
       "           Ccnumber           Address Country  \n",
       "0  6375508819454279   716 Kuchu Grove      EH  \n",
       "1  5468218154515383     468 Tube Loop      CH  \n",
       "2  4903855020206477     271 Ecgek Key      AL  \n",
       "3   349976912136984  1059 Pivsog Lane      ZW  \n",
       "4  3528302763283717   431 Nosvid Glen      PR  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "datacopy['Age'] = datacopy['Age'].astype('int16')\n",
    "datacopy['Driving_License'] = datacopy['Driving_License'].astype('bool')\n",
    "datacopy['Previously_Insured'] = datacopy['Previously_Insured'].astype('bool')\n",
    "datacopy['Vintage'] = datacopy['Vintage'].astype('bool')\n",
    "datacopy['Vehicle_Damage'] = datacopy['Vehicle_Damage'].astype('bool')\n",
    "datacopy['Response'] = datacopy['Response'].astype('bool')\n",
    "datacopy['Policy_Sales_Channel'] = (datacopy['Policy_Sales_Channel']).astype(int).astype(str)\n",
    "datacopy['Vehicle_Age'] = datacopy['Vehicle_Age'].astype('int16')\n",
    "datacopy['Annual_Premium'] = datacopy['Annual_Premium'].astype('int64')\n",
    "datacopy['Ccnumber'] = datacopy['Ccnumber'].astype('str')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Gender                  object\n",
       "Age                      int16\n",
       "Driving_License           bool\n",
       "Previously_Insured        bool\n",
       "Vehicle_Age              int16\n",
       "Vehicle_Damage            bool\n",
       "Annual_Premium           int64\n",
       "Policy_Sales_Channel    object\n",
       "Vintage                   bool\n",
       "Response                  bool\n",
       "Ccnumber                object\n",
       "Address                 object\n",
       "Country                 object\n",
       "dtype: object"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.dtypes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Verificamos data booleana y que tanto nos sirve para el analisis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Driving_License</th>\n",
       "      <th>Previously_Insured</th>\n",
       "      <th>Vehicle_Damage</th>\n",
       "      <th>Vintage</th>\n",
       "      <th>Response</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381104</th>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381105</th>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381106</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381107</th>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381108</th>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>381109 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Driving_License  Previously_Insured  Vehicle_Damage  Vintage  Response\n",
       "0                  True                True            True     True     False\n",
       "1                  True                True            True     True     False\n",
       "2                  True                True            True     True     False\n",
       "3                  True                True            True     True     False\n",
       "4                  True               False            True     True     False\n",
       "...                 ...                 ...             ...      ...       ...\n",
       "381104             True               False            True     True     False\n",
       "381105             True               False            True     True      True\n",
       "381106             True                True            True     True     False\n",
       "381107             True               False            True     True      True\n",
       "381108             True                True            True     True     False\n",
       "\n",
       "[381109 rows x 5 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[['Driving_License','Previously_Insured','Vehicle_Damage','Vintage','Response']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 397,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Driving_License  Previously_Insured  Vehicle_Damage  Vintage  Response\n",
       "True             True                True            True     False       174229\n",
       "                 False               True            True     False       159399\n",
       "                                                              True         46511\n",
       "False            False               True            True     False          530\n",
       "                 True                True            True     False          241\n",
       "True             True                True            True     True           158\n",
       "False            False               True            True     True            41\n",
       "dtype: int64"
      ]
     },
     "execution_count": 397,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[['Driving_License','Previously_Insured','Vehicle_Damage','Vintage','Response']].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 398,
   "metadata": {},
   "outputs": [],
   "source": [
    "datacopy.drop(['Driving_License','Previously_Insured','Vehicle_Damage','Vintage','Response'],axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A falta de tecnicas de anonimizacion de data booleana lo droppeamos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 399,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>26</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>33053</td>\n",
       "      <td>152</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>35804</td>\n",
       "      <td>124</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>39874</td>\n",
       "      <td>152</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>38933</td>\n",
       "      <td>156</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Male</td>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>35953</td>\n",
       "      <td>152</td>\n",
       "      <td>6291266469094991</td>\n",
       "      <td>1728 Hekka Way</td>\n",
       "      <td>FR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Male</td>\n",
       "      <td>46</td>\n",
       "      <td>2</td>\n",
       "      <td>40351</td>\n",
       "      <td>124</td>\n",
       "      <td>6304333700021079</td>\n",
       "      <td>1744 Wopi Square</td>\n",
       "      <td>FI</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Male</td>\n",
       "      <td>56</td>\n",
       "      <td>6</td>\n",
       "      <td>35973</td>\n",
       "      <td>13</td>\n",
       "      <td>6334820291146251</td>\n",
       "      <td>583 Gafta Highway</td>\n",
       "      <td>TL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Female</td>\n",
       "      <td>61</td>\n",
       "      <td>2</td>\n",
       "      <td>38039</td>\n",
       "      <td>124</td>\n",
       "      <td>5165131194360486</td>\n",
       "      <td>1246 Niju Circle</td>\n",
       "      <td>TA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Male</td>\n",
       "      <td>66</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>124</td>\n",
       "      <td>5104432148050775</td>\n",
       "      <td>281 Ehjo Pass</td>\n",
       "      <td>VG</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0    Male   57            2            2630                   26   \n",
       "1  Female   23            1           33053                  152   \n",
       "2  Female   47            2           35804                  124   \n",
       "3    Male   27            1           39874                  152   \n",
       "4  Female   47            2           38933                  156   \n",
       "5    Male   24            1           35953                  152   \n",
       "6    Male   46            2           40351                  124   \n",
       "7    Male   56            6           35973                   13   \n",
       "8  Female   61            2           38039                  124   \n",
       "9    Male   66            2            2630                  124   \n",
       "\n",
       "           Ccnumber            Address Country  \n",
       "0  6375508819454279    716 Kuchu Grove      EH  \n",
       "1  5468218154515383      468 Tube Loop      CH  \n",
       "2  4903855020206477      271 Ecgek Key      AL  \n",
       "3   349976912136984   1059 Pivsog Lane      ZW  \n",
       "4  3528302763283717    431 Nosvid Glen      PR  \n",
       "5  6291266469094991     1728 Hekka Way      FR  \n",
       "6  6304333700021079   1744 Wopi Square      FI  \n",
       "7  6334820291146251  583 Gafta Highway      TL  \n",
       "8  5165131194360486   1246 Niju Circle      TA  \n",
       "9  5104432148050775      281 Ehjo Pass      VG  "
      ]
     },
     "execution_count": 399,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Anonimizar Policy Sales Channel\n",
    "\n",
    "Nuestra idea es asignar un nombre categorico a cada uno de los posibles codigos anonimizados\n",
    "\n",
    "por ejemplo si tiene un * 2 * es que es En Persona, un * 1 * por correo, * 4 * mensaje automatico, etc.\n",
    "\n",
    "Para que tenga un sentido semantico y util al momento de analizar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 400,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "163"
      ]
     },
     "execution_count": 400,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Policy_Sales_Channel'].value_counts().reset_index()['index'].astype('int64').max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 401,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 401,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Policy_Sales_Channel'].apply(len).min()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 402,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3"
      ]
     },
     "execution_count": 402,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Policy_Sales_Channel'].apply(len).max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 403,
   "metadata": {},
   "outputs": [],
   "source": [
    "datacopy['Policy_Sales_Channel'] = datacopy['Policy_Sales_Channel'].apply(lambda r : r.zfill(3))\n",
    "datacopy['Policy_Sales_Channel'] = datacopy['Policy_Sales_Channel'].apply(lambda x: '*{}*'.format(x[1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 404,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0    Male   57            2            2630                  *2*   \n",
       "1  Female   23            1           33053                  *5*   \n",
       "2  Female   47            2           35804                  *2*   \n",
       "\n",
       "           Ccnumber          Address Country  \n",
       "0  6375508819454279  716 Kuchu Grove      EH  \n",
       "1  5468218154515383    468 Tube Loop      CH  \n",
       "2  4903855020206477    271 Ecgek Key      AL  "
      ]
     },
     "execution_count": 404,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 405,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Male</td>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>35953</td>\n",
       "      <td>*5*</td>\n",
       "      <td>6291266469094991</td>\n",
       "      <td>1728 Hekka Way</td>\n",
       "      <td>FR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Male</td>\n",
       "      <td>46</td>\n",
       "      <td>2</td>\n",
       "      <td>40351</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6304333700021079</td>\n",
       "      <td>1744 Wopi Square</td>\n",
       "      <td>FI</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Male</td>\n",
       "      <td>56</td>\n",
       "      <td>6</td>\n",
       "      <td>35973</td>\n",
       "      <td>*1*</td>\n",
       "      <td>6334820291146251</td>\n",
       "      <td>583 Gafta Highway</td>\n",
       "      <td>TL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Female</td>\n",
       "      <td>61</td>\n",
       "      <td>2</td>\n",
       "      <td>38039</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5165131194360486</td>\n",
       "      <td>1246 Niju Circle</td>\n",
       "      <td>TA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Male</td>\n",
       "      <td>66</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5104432148050775</td>\n",
       "      <td>281 Ehjo Pass</td>\n",
       "      <td>VG</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0    Male   57            2            2630                  *2*   \n",
       "1  Female   23            1           33053                  *5*   \n",
       "2  Female   47            2           35804                  *2*   \n",
       "3    Male   27            1           39874                  *5*   \n",
       "4  Female   47            2           38933                  *5*   \n",
       "5    Male   24            1           35953                  *5*   \n",
       "6    Male   46            2           40351                  *2*   \n",
       "7    Male   56            6           35973                  *1*   \n",
       "8  Female   61            2           38039                  *2*   \n",
       "9    Male   66            2            2630                  *2*   \n",
       "\n",
       "           Ccnumber            Address Country  \n",
       "0  6375508819454279    716 Kuchu Grove      EH  \n",
       "1  5468218154515383      468 Tube Loop      CH  \n",
       "2  4903855020206477      271 Ecgek Key      AL  \n",
       "3   349976912136984   1059 Pivsog Lane      ZW  \n",
       "4  3528302763283717    431 Nosvid Glen      PR  \n",
       "5  6291266469094991     1728 Hekka Way      FR  \n",
       "6  6304333700021079   1744 Wopi Square      FI  \n",
       "7  6334820291146251  583 Gafta Highway      TL  \n",
       "8  5165131194360486   1246 Niju Circle      TA  \n",
       "9  5104432148050775      281 Ehjo Pass      VG  "
      ]
     },
     "execution_count": 405,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 406,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "*2*    170157\n",
       "*5*    167374\n",
       "*6*     25973\n",
       "*1*      7047\n",
       "*0*      5812\n",
       "*3*      3228\n",
       "*4*       971\n",
       "*9*       348\n",
       "*8*       140\n",
       "*7*        59\n",
       "Name: Policy_Sales_Channel, dtype: int64"
      ]
     },
     "execution_count": 406,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Policy_Sales_Channel'].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Casi Identificables: KEEP\n",
    "- Age \n",
    "- Gender\n",
    "- Country\n",
    "- Previously_Insured\n",
    "- Vehicle_Age \n",
    "- Vehicle_Damage\n",
    "- Vintage\n",
    "- Response\n",
    "- Driving_License\n",
    "- address \n",
    "- Policy_Sales_Channel\n",
    "# Sensibles: KEEP\n",
    "- CCNumber\n",
    "- Annual_Premium\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Address"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 407,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1526 Dovu Center       2\n",
       "236 Ocpo Way           2\n",
       "1430 Ohco Glen         2\n",
       "869 Hizil Drive        2\n",
       "810 Dejos Ridge        2\n",
       "                      ..\n",
       "1352 Otiv Park         1\n",
       "1528 Ombaz Junction    1\n",
       "1212 Facko View        1\n",
       "1481 Fitop Way         1\n",
       "1273 Egoku Avenue      1\n",
       "Name: Address, Length: 381104, dtype: int64"
      ]
     },
     "execution_count": 407,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Address'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 408,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>716 Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>468 Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>271 Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>1059 Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>431 Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0    Male   57            2            2630                  *2*   \n",
       "1  Female   23            1           33053                  *5*   \n",
       "2  Female   47            2           35804                  *2*   \n",
       "3    Male   27            1           39874                  *5*   \n",
       "4  Female   47            2           38933                  *5*   \n",
       "\n",
       "           Ccnumber           Address Country  \n",
       "0  6375508819454279   716 Kuchu Grove      EH  \n",
       "1  5468218154515383     468 Tube Loop      CH  \n",
       "2  4903855020206477     271 Ecgek Key      AL  \n",
       "3   349976912136984  1059 Pivsog Lane      ZW  \n",
       "4  3528302763283717   431 Nosvid Glen      PR  "
      ]
     },
     "execution_count": 408,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 409,
   "metadata": {},
   "outputs": [],
   "source": [
    "datacopy['Address'] = datacopy['Address'].apply(lambda x: (x.split()[1]+' '+x.split()[2]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 410,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender  Age  Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0    Male   57            2            2630                  *2*   \n",
       "1  Female   23            1           33053                  *5*   \n",
       "2  Female   47            2           35804                  *2*   \n",
       "3    Male   27            1           39874                  *5*   \n",
       "4  Female   47            2           38933                  *5*   \n",
       "\n",
       "           Ccnumber      Address Country  \n",
       "0  6375508819454279  Kuchu Grove      EH  \n",
       "1  5468218154515383    Tube Loop      CH  \n",
       "2  4903855020206477    Ecgek Key      AL  \n",
       "3   349976912136984  Pivsog Lane      ZW  \n",
       "4  3528302763283717  Nosvid Glen      PR  "
      ]
     },
     "execution_count": 410,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 411,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Dofo Lane        5\n",
       "Ruwa River       4\n",
       "Bowa Turnpike    4\n",
       "Lona Pike        4\n",
       "Taka River       4\n",
       "                ..\n",
       "Datez Way        1\n",
       "Suvdih Pass      1\n",
       "Vupi Parkway     1\n",
       "Pirid Avenue     1\n",
       "Egoku Avenue     1\n",
       "Name: Address, Length: 373377, dtype: int64"
      ]
     },
     "execution_count": 411,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Address'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 412,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1    366057\n",
       "2      6927\n",
       "3       375\n",
       "4        17\n",
       "5         1\n",
       "Name: Address, dtype: int64"
      ]
     },
     "execution_count": 412,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Address'].value_counts().value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 413,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381104</th>\n",
       "      <td>Female</td>\n",
       "      <td>57</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>201430927663571</td>\n",
       "      <td>Reniku Street</td>\n",
       "      <td>SC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381105</th>\n",
       "      <td>Male</td>\n",
       "      <td>65</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5170330091208391</td>\n",
       "      <td>Feha Glen</td>\n",
       "      <td>GT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381106</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>1</td>\n",
       "      <td>26144</td>\n",
       "      <td>*5*</td>\n",
       "      <td>30041617114838</td>\n",
       "      <td>Kikcod Loop</td>\n",
       "      <td>GW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381107</th>\n",
       "      <td>Male</td>\n",
       "      <td>56</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5134839279775992</td>\n",
       "      <td>Jogo Drive</td>\n",
       "      <td>CA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381108</th>\n",
       "      <td>Male</td>\n",
       "      <td>52</td>\n",
       "      <td>2</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5486049053074547</td>\n",
       "      <td>Egoku Avenue</td>\n",
       "      <td>KY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>381109 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Gender  Age  Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0         Male   57            2            2630                  *2*   \n",
       "1       Female   23            1           33053                  *5*   \n",
       "2       Female   47            2           35804                  *2*   \n",
       "3         Male   27            1           39874                  *5*   \n",
       "4       Female   47            2           38933                  *5*   \n",
       "...        ...  ...          ...             ...                  ...   \n",
       "381104  Female   57            2            2630                  *5*   \n",
       "381105    Male   65            2            2630                  *2*   \n",
       "381106    Male   27            1           26144                  *5*   \n",
       "381107    Male   56            2            2630                  *5*   \n",
       "381108    Male   52            2            2630                  *2*   \n",
       "\n",
       "                Ccnumber        Address Country  \n",
       "0       6375508819454279    Kuchu Grove      EH  \n",
       "1       5468218154515383      Tube Loop      CH  \n",
       "2       4903855020206477      Ecgek Key      AL  \n",
       "3        349976912136984    Pivsog Lane      ZW  \n",
       "4       3528302763283717    Nosvid Glen      PR  \n",
       "...                  ...            ...     ...  \n",
       "381104   201430927663571  Reniku Street      SC  \n",
       "381105  5170330091208391      Feha Glen      GT  \n",
       "381106    30041617114838    Kikcod Loop      GW  \n",
       "381107  5134839279775992     Jogo Drive      CA  \n",
       "381108  5486049053074547   Egoku Avenue      KY  \n",
       "\n",
       "[381109 rows x 8 columns]"
      ]
     },
     "execution_count": 413,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Vehicle Age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 414,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2    200316\n",
       "1    164786\n",
       "5      4008\n",
       "6      3962\n",
       "4      3938\n",
       "3      2088\n",
       "7      2011\n",
       "Name: Vehicle_Age, dtype: int64"
      ]
     },
     "execution_count": 414,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Vehicle_Age'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 415,
   "metadata": {},
   "outputs": [],
   "source": [
    "age_mapping = {1: 'Casi Nuevo', 2: 'Casi Nuevo', 3: 'Casi Nuevo',\n",
    "               4: 'Desgastado', 5: 'Desgastado',\n",
    "               6: 'Deplorable', 7: 'Deplorable'}\n",
    "\n",
    "datacopy['Vehicle_Age'].replace(age_mapping, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 416,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>47</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381104</th>\n",
       "      <td>Female</td>\n",
       "      <td>57</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>201430927663571</td>\n",
       "      <td>Reniku Street</td>\n",
       "      <td>SC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381105</th>\n",
       "      <td>Male</td>\n",
       "      <td>65</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5170330091208391</td>\n",
       "      <td>Feha Glen</td>\n",
       "      <td>GT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381106</th>\n",
       "      <td>Male</td>\n",
       "      <td>27</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>26144</td>\n",
       "      <td>*5*</td>\n",
       "      <td>30041617114838</td>\n",
       "      <td>Kikcod Loop</td>\n",
       "      <td>GW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381107</th>\n",
       "      <td>Male</td>\n",
       "      <td>56</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5134839279775992</td>\n",
       "      <td>Jogo Drive</td>\n",
       "      <td>CA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381108</th>\n",
       "      <td>Male</td>\n",
       "      <td>52</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5486049053074547</td>\n",
       "      <td>Egoku Avenue</td>\n",
       "      <td>KY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>381109 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Gender  Age Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0         Male   57  Casi Nuevo            2630                  *2*   \n",
       "1       Female   23  Casi Nuevo           33053                  *5*   \n",
       "2       Female   47  Casi Nuevo           35804                  *2*   \n",
       "3         Male   27  Casi Nuevo           39874                  *5*   \n",
       "4       Female   47  Casi Nuevo           38933                  *5*   \n",
       "...        ...  ...         ...             ...                  ...   \n",
       "381104  Female   57  Casi Nuevo            2630                  *5*   \n",
       "381105    Male   65  Casi Nuevo            2630                  *2*   \n",
       "381106    Male   27  Casi Nuevo           26144                  *5*   \n",
       "381107    Male   56  Casi Nuevo            2630                  *5*   \n",
       "381108    Male   52  Casi Nuevo            2630                  *2*   \n",
       "\n",
       "                Ccnumber        Address Country  \n",
       "0       6375508819454279    Kuchu Grove      EH  \n",
       "1       5468218154515383      Tube Loop      CH  \n",
       "2       4903855020206477      Ecgek Key      AL  \n",
       "3        349976912136984    Pivsog Lane      ZW  \n",
       "4       3528302763283717    Nosvid Glen      PR  \n",
       "...                  ...            ...     ...  \n",
       "381104   201430927663571  Reniku Street      SC  \n",
       "381105  5170330091208391      Feha Glen      GT  \n",
       "381106    30041617114838    Kikcod Loop      GW  \n",
       "381107  5134839279775992     Jogo Drive      CA  \n",
       "381108  5486049053074547   Egoku Avenue      KY  \n",
       "\n",
       "[381109 rows x 8 columns]"
      ]
     },
     "execution_count": 416,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 417,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Casi Nuevo', 'Deplorable', 'Desgastado'], dtype=object)"
      ]
     },
     "execution_count": 417,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.Vehicle_Age.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 418,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Casi Nuevo    367190\n",
       "Desgastado      7946\n",
       "Deplorable      5973\n",
       "Name: Vehicle_Age, dtype: int64"
      ]
     },
     "execution_count": 418,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.Vehicle_Age.value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 419,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "24    25960\n",
       "23    24256\n",
       "22    20964\n",
       "25    20636\n",
       "21    16457\n",
       "      ...  \n",
       "81       56\n",
       "82       29\n",
       "83       22\n",
       "84       11\n",
       "85       11\n",
       "Name: Age, Length: 66, dtype: int64"
      ]
     },
     "execution_count": 419,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Age'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 420,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "20"
      ]
     },
     "execution_count": 420,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[\"Age\"].min()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 421,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "85"
      ]
     },
     "execution_count": 421,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[\"Age\"].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 422,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define los límites de los intervalos\n",
    "bins = [19, 30, 40, 50, 60, 70, 80, 86]\n",
    "\n",
    "# Define las etiquetas para cada intervalo\n",
    "labels = ['20-29', '30-39', '40-49', '50-59', '60-69', '70-79', '80-85']\n",
    "\n",
    "# Utiliza la función cut para agrupar las edades y asignar las etiquetas\n",
    "datacopy['Age'] = pd.cut(datacopy['Age'], bins=bins, labels=labels, include_lowest=True, right=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 423,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>349976912136984</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381104</th>\n",
       "      <td>Female</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>201430927663571</td>\n",
       "      <td>Reniku Street</td>\n",
       "      <td>SC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381105</th>\n",
       "      <td>Male</td>\n",
       "      <td>60-69</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5170330091208391</td>\n",
       "      <td>Feha Glen</td>\n",
       "      <td>GT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381106</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>26144</td>\n",
       "      <td>*5*</td>\n",
       "      <td>30041617114838</td>\n",
       "      <td>Kikcod Loop</td>\n",
       "      <td>GW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381107</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5134839279775992</td>\n",
       "      <td>Jogo Drive</td>\n",
       "      <td>CA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381108</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5486049053074547</td>\n",
       "      <td>Egoku Avenue</td>\n",
       "      <td>KY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>381109 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Gender    Age Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0         Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "1       Female  20-29  Casi Nuevo           33053                  *5*   \n",
       "2       Female  40-49  Casi Nuevo           35804                  *2*   \n",
       "3         Male  20-29  Casi Nuevo           39874                  *5*   \n",
       "4       Female  40-49  Casi Nuevo           38933                  *5*   \n",
       "...        ...    ...         ...             ...                  ...   \n",
       "381104  Female  50-59  Casi Nuevo            2630                  *5*   \n",
       "381105    Male  60-69  Casi Nuevo            2630                  *2*   \n",
       "381106    Male  20-29  Casi Nuevo           26144                  *5*   \n",
       "381107    Male  50-59  Casi Nuevo            2630                  *5*   \n",
       "381108    Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "\n",
       "                Ccnumber        Address Country  \n",
       "0       6375508819454279    Kuchu Grove      EH  \n",
       "1       5468218154515383      Tube Loop      CH  \n",
       "2       4903855020206477      Ecgek Key      AL  \n",
       "3        349976912136984    Pivsog Lane      ZW  \n",
       "4       3528302763283717    Nosvid Glen      PR  \n",
       "...                  ...            ...     ...  \n",
       "381104   201430927663571  Reniku Street      SC  \n",
       "381105  5170330091208391      Feha Glen      GT  \n",
       "381106    30041617114838    Kikcod Loop      GW  \n",
       "381107  5134839279775992     Jogo Drive      CA  \n",
       "381108  5486049053074547   Egoku Avenue      KY  \n",
       "\n",
       "[381109 rows x 8 columns]"
      ]
     },
     "execution_count": 423,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 424,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "20-29    155203\n",
       "40-49     76846\n",
       "30-39     54253\n",
       "50-59     48034\n",
       "60-69     29023\n",
       "70-79     16712\n",
       "80-85      1038\n",
       "Name: Age, dtype: int64"
      ]
     },
     "execution_count": 424,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.Age.value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## CCNumber"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Aqui queremos encriptar en backend, pero al momento de mostrar en frontend que se muestre asi!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 425,
   "metadata": {},
   "outputs": [],
   "source": [
    "import random"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 426,
   "metadata": {},
   "outputs": [],
   "source": [
    "def estandarizar_ccnumber(cc):\n",
    "    cc = ''.join(c for c in str(cc) if c.isdigit())\n",
    "    \n",
    "    if len(cc) < 16:\n",
    "        cc += ''.join(str(random.randint(0, 9)) for _ in range(16 - len(cc)))\n",
    "    elif len(cc) > 16:\n",
    "        cc = cc[:16]\n",
    "    \n",
    "    return cc\n",
    "\n",
    "datacopy['Ccnumber'] = datacopy['Ccnumber'].apply(estandarizar_ccnumber)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 427,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375508819454279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468218154515383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903855020206477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3499769121369844</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528302763283717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381104</th>\n",
       "      <td>Female</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>2014309276635717</td>\n",
       "      <td>Reniku Street</td>\n",
       "      <td>SC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381105</th>\n",
       "      <td>Male</td>\n",
       "      <td>60-69</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5170330091208391</td>\n",
       "      <td>Feha Glen</td>\n",
       "      <td>GT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381106</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>26144</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3004161711483816</td>\n",
       "      <td>Kikcod Loop</td>\n",
       "      <td>GW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381107</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5134839279775992</td>\n",
       "      <td>Jogo Drive</td>\n",
       "      <td>CA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381108</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5486049053074547</td>\n",
       "      <td>Egoku Avenue</td>\n",
       "      <td>KY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>381109 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Gender    Age Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0         Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "1       Female  20-29  Casi Nuevo           33053                  *5*   \n",
       "2       Female  40-49  Casi Nuevo           35804                  *2*   \n",
       "3         Male  20-29  Casi Nuevo           39874                  *5*   \n",
       "4       Female  40-49  Casi Nuevo           38933                  *5*   \n",
       "...        ...    ...         ...             ...                  ...   \n",
       "381104  Female  50-59  Casi Nuevo            2630                  *5*   \n",
       "381105    Male  60-69  Casi Nuevo            2630                  *2*   \n",
       "381106    Male  20-29  Casi Nuevo           26144                  *5*   \n",
       "381107    Male  50-59  Casi Nuevo            2630                  *5*   \n",
       "381108    Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "\n",
       "                Ccnumber        Address Country  \n",
       "0       6375508819454279    Kuchu Grove      EH  \n",
       "1       5468218154515383      Tube Loop      CH  \n",
       "2       4903855020206477      Ecgek Key      AL  \n",
       "3       3499769121369844    Pivsog Lane      ZW  \n",
       "4       3528302763283717    Nosvid Glen      PR  \n",
       "...                  ...            ...     ...  \n",
       "381104  2014309276635717  Reniku Street      SC  \n",
       "381105  5170330091208391      Feha Glen      GT  \n",
       "381106  3004161711483816    Kikcod Loop      GW  \n",
       "381107  5134839279775992     Jogo Drive      CA  \n",
       "381108  5486049053074547   Egoku Avenue      KY  \n",
       "\n",
       "[381109 rows x 8 columns]"
      ]
     },
     "execution_count": 427,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 428,
   "metadata": {},
   "outputs": [],
   "source": [
    "def estandarizar_enmascarar_ccnumber(cc):\n",
    "    cc = ''.join(c for c in str(cc) if c.isdigit())\n",
    "    \n",
    "    if len(cc) < 16:\n",
    "        cc += ''.join(str(random.randint(0, 9)) for _ in range(16 - len(cc)))\n",
    "    elif len(cc) > 16:\n",
    "        cc = cc[:16]\n",
    "    \n",
    "    cc = cc[:4] + '*' * 8 + cc[12:] # + '*' * 4\n",
    "    \n",
    "    return cc\n",
    "\n",
    "datacopy['Ccnumber'] = datacopy['Ccnumber'].apply(estandarizar_enmascarar_ccnumber)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 429,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375********4279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468********5383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903********6477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3499********9844</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528********3717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381104</th>\n",
       "      <td>Female</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>2014********5717</td>\n",
       "      <td>Reniku Street</td>\n",
       "      <td>SC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381105</th>\n",
       "      <td>Male</td>\n",
       "      <td>60-69</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5170********8391</td>\n",
       "      <td>Feha Glen</td>\n",
       "      <td>GT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381106</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>26144</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3004********3816</td>\n",
       "      <td>Kikcod Loop</td>\n",
       "      <td>GW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381107</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5134********5992</td>\n",
       "      <td>Jogo Drive</td>\n",
       "      <td>CA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>381108</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5486********4547</td>\n",
       "      <td>Egoku Avenue</td>\n",
       "      <td>KY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>381109 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Gender    Age Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0         Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "1       Female  20-29  Casi Nuevo           33053                  *5*   \n",
       "2       Female  40-49  Casi Nuevo           35804                  *2*   \n",
       "3         Male  20-29  Casi Nuevo           39874                  *5*   \n",
       "4       Female  40-49  Casi Nuevo           38933                  *5*   \n",
       "...        ...    ...         ...             ...                  ...   \n",
       "381104  Female  50-59  Casi Nuevo            2630                  *5*   \n",
       "381105    Male  60-69  Casi Nuevo            2630                  *2*   \n",
       "381106    Male  20-29  Casi Nuevo           26144                  *5*   \n",
       "381107    Male  50-59  Casi Nuevo            2630                  *5*   \n",
       "381108    Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "\n",
       "                Ccnumber        Address Country  \n",
       "0       6375********4279    Kuchu Grove      EH  \n",
       "1       5468********5383      Tube Loop      CH  \n",
       "2       4903********6477      Ecgek Key      AL  \n",
       "3       3499********9844    Pivsog Lane      ZW  \n",
       "4       3528********3717    Nosvid Glen      PR  \n",
       "...                  ...            ...     ...  \n",
       "381104  2014********5717  Reniku Street      SC  \n",
       "381105  5170********8391      Feha Glen      GT  \n",
       "381106  3004********3816    Kikcod Loop      GW  \n",
       "381107  5134********5992     Jogo Drive      CA  \n",
       "381108  5486********4547   Egoku Avenue      KY  \n",
       "\n",
       "[381109 rows x 8 columns]"
      ]
     },
     "execution_count": 429,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Planes!\n",
    "\n",
    "Address reemplazar con zipcodes aleatorios y luego enmascarar con *****\n",
    "\n",
    "Para country vemos que no hay muchos problemas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 430,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "US    3045\n",
       "FK    1596\n",
       "KH    1590\n",
       "SG    1589\n",
       "AM    1588\n",
       "      ... \n",
       "ER    1424\n",
       "AF    1424\n",
       "CY    1411\n",
       "BA    1410\n",
       "GB    1409\n",
       "Name: Country, Length: 252, dtype: int64"
      ]
     },
     "execution_count": 430,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy['Country'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 431,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Los originales\n",
    "\n",
    "QI = ['Age','Gender','Country','Vehicle_Age','Address','Policy_Sales_Channel']\n",
    "SA = ['Ccnumber','Annual_Premium']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 432,
   "metadata": {},
   "outputs": [],
   "source": [
    "QI = ['Age','Vehicle_Age','Policy_Sales_Channel']\n",
    "SA = ['Ccnumber','Annual_Premium']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 433,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Annual_Premium</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>Ccnumber</th>\n",
       "      <th>Address</th>\n",
       "      <th>Country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6375********4279</td>\n",
       "      <td>Kuchu Grove</td>\n",
       "      <td>EH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>33053</td>\n",
       "      <td>*5*</td>\n",
       "      <td>5468********5383</td>\n",
       "      <td>Tube Loop</td>\n",
       "      <td>CH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>35804</td>\n",
       "      <td>*2*</td>\n",
       "      <td>4903********6477</td>\n",
       "      <td>Ecgek Key</td>\n",
       "      <td>AL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>39874</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3499********9844</td>\n",
       "      <td>Pivsog Lane</td>\n",
       "      <td>ZW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>38933</td>\n",
       "      <td>*5*</td>\n",
       "      <td>3528********3717</td>\n",
       "      <td>Nosvid Glen</td>\n",
       "      <td>PR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Male</td>\n",
       "      <td>20-29</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>35953</td>\n",
       "      <td>*5*</td>\n",
       "      <td>6291********4991</td>\n",
       "      <td>Hekka Way</td>\n",
       "      <td>FR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Male</td>\n",
       "      <td>40-49</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>40351</td>\n",
       "      <td>*2*</td>\n",
       "      <td>6304********1079</td>\n",
       "      <td>Wopi Square</td>\n",
       "      <td>FI</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Male</td>\n",
       "      <td>50-59</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>35973</td>\n",
       "      <td>*1*</td>\n",
       "      <td>6334********6251</td>\n",
       "      <td>Gafta Highway</td>\n",
       "      <td>TL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Female</td>\n",
       "      <td>60-69</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>38039</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5165********0486</td>\n",
       "      <td>Niju Circle</td>\n",
       "      <td>TA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Male</td>\n",
       "      <td>60-69</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>2630</td>\n",
       "      <td>*2*</td>\n",
       "      <td>5104********0775</td>\n",
       "      <td>Ehjo Pass</td>\n",
       "      <td>VG</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Gender    Age Vehicle_Age  Annual_Premium Policy_Sales_Channel  \\\n",
       "0    Male  50-59  Casi Nuevo            2630                  *2*   \n",
       "1  Female  20-29  Casi Nuevo           33053                  *5*   \n",
       "2  Female  40-49  Casi Nuevo           35804                  *2*   \n",
       "3    Male  20-29  Casi Nuevo           39874                  *5*   \n",
       "4  Female  40-49  Casi Nuevo           38933                  *5*   \n",
       "5    Male  20-29  Casi Nuevo           35953                  *5*   \n",
       "6    Male  40-49  Casi Nuevo           40351                  *2*   \n",
       "7    Male  50-59  Deplorable           35973                  *1*   \n",
       "8  Female  60-69  Casi Nuevo           38039                  *2*   \n",
       "9    Male  60-69  Casi Nuevo            2630                  *2*   \n",
       "\n",
       "           Ccnumber        Address Country  \n",
       "0  6375********4279    Kuchu Grove      EH  \n",
       "1  5468********5383      Tube Loop      CH  \n",
       "2  4903********6477      Ecgek Key      AL  \n",
       "3  3499********9844    Pivsog Lane      ZW  \n",
       "4  3528********3717    Nosvid Glen      PR  \n",
       "5  6291********4991      Hekka Way      FR  \n",
       "6  6304********1079    Wopi Square      FI  \n",
       "7  6334********6251  Gafta Highway      TL  \n",
       "8  5165********0486    Niju Circle      TA  \n",
       "9  5104********0775      Ehjo Pass      VG  "
      ]
     },
     "execution_count": 433,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[:10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 434,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 434,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "k = anonymity.k_anonymity(datacopy[:10], QI)\n",
    "k"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 440,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(381109, 8)"
      ]
     },
     "execution_count": 440,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 334,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Age    Vehicle_Age  Policy_Sales_Channel\n",
       "20-29  Casi Nuevo   *5*                     124639\n",
       "40-49  Casi Nuevo   *2*                      56945\n",
       "50-59  Casi Nuevo   *2*                      34415\n",
       "30-39  Casi Nuevo   *2*                      25608\n",
       "                    *5*                      23419\n",
       "                                             ...  \n",
       "80-85  Casi Nuevo   *7*                          1\n",
       "40-49  Deplorable   *7*                          1\n",
       "60-69  Deplorable   *8*                          1\n",
       "80-85  Casi Nuevo   *4*                          1\n",
       "       Desgastado   *6*                          1\n",
       "Length: 166, dtype: int64"
      ]
     },
     "execution_count": 334,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[['Age','Vehicle_Age','Policy_Sales_Channel']].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Drop"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Con histogramas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 441,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Vehicle_Age</th>\n",
       "      <th>Policy_Sales_Channel</th>\n",
       "      <th>0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>165</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*6*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>70-79</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*9*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150</th>\n",
       "      <td>50-59</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*7*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>151</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*3*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>152</th>\n",
       "      <td>40-49</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*8*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>153</th>\n",
       "      <td>50-59</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*7*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>154</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*0*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>155</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*3*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>164</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>*4*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>157</th>\n",
       "      <td>70-79</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*9*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>158</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*0*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159</th>\n",
       "      <td>40-49</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*9*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>160</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>*8*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>161</th>\n",
       "      <td>80-85</td>\n",
       "      <td>Casi Nuevo</td>\n",
       "      <td>*7*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>162</th>\n",
       "      <td>40-49</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*7*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>163</th>\n",
       "      <td>60-69</td>\n",
       "      <td>Deplorable</td>\n",
       "      <td>*8*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>156</th>\n",
       "      <td>50-59</td>\n",
       "      <td>Desgastado</td>\n",
       "      <td>*8*</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Age Vehicle_Age Policy_Sales_Channel  0\n",
       "165  80-85  Desgastado                  *6*  1\n",
       "149  70-79  Desgastado                  *9*  1\n",
       "150  50-59  Desgastado                  *7*  1\n",
       "151  80-85  Desgastado                  *3*  1\n",
       "152  40-49  Desgastado                  *8*  1\n",
       "153  50-59  Deplorable                  *7*  1\n",
       "154  80-85  Desgastado                  *0*  1\n",
       "155  80-85  Deplorable                  *3*  1\n",
       "164  80-85  Casi Nuevo                  *4*  1\n",
       "157  70-79  Deplorable                  *9*  1\n",
       "158  80-85  Deplorable                  *0*  1\n",
       "159  40-49  Deplorable                  *9*  1\n",
       "160  80-85  Casi Nuevo                  *8*  1\n",
       "161  80-85  Casi Nuevo                  *7*  1\n",
       "162  40-49  Deplorable                  *7*  1\n",
       "163  60-69  Deplorable                  *8*  1\n",
       "156  50-59  Desgastado                  *8*  1"
      ]
     },
     "execution_count": 441,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[['Age','Vehicle_Age','Policy_Sales_Channel']].value_counts().reset_index().sort_values(0).iloc[:17]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 436,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(381109, 8)"
      ]
     },
     "execution_count": 436,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 435,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1      17\n",
       "6       5\n",
       "2       5\n",
       "11      5\n",
       "8       4\n",
       "       ..\n",
       "811     1\n",
       "850     1\n",
       "874     1\n",
       "915     1\n",
       "175     1\n",
       "Length: 100, dtype: int64"
      ]
     },
     "execution_count": 435,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datacopy[['Age','Vehicle_Age','Policy_Sales_Channel']].value_counts().value_counts()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
